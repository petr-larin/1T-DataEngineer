CREATE TABLE IF NOT EXISTS public.products
(
    product_id int PRIMARY KEY,
    product_name varchar(32),
    price decimal
);

CREATE TABLE IF NOT EXISTS public.shops
(
    shop_id int PRIMARY KEY,
    shop_name varchar(32)
);

CREATE TABLE IF NOT EXISTS public.plan
(
    product_id int,
    shop_name varchar(32),
    plan_cnt int,
    plan_date date
);

CREATE TABLE IF NOT EXISTS public.shop_dns
(
    date date,
    product_id int,
    sales_cnt int
);

CREATE TABLE IF NOT EXISTS public.shop_mvideo
(
    date date,
    product_id int,
    sales_cnt int
);

CREATE TABLE IF NOT EXISTS public.shop_sitilink
(
    date date,
    product_id int,
    sales_cnt int
);

CREATE TABLE IF NOT EXISTS public.promo
(
    shop_id int,
    promo_date date,
    product_id int,
    discount float
);

-----------------------------------

INSERT INTO public.products(product_id, product_name, price)
VALUES
(0, 'Испорченный телефон', 100),
(1, 'Сарафанное радио', 125),
(2, 'Патефон', 150);

INSERT INTO public.shops(shop_id, shop_name)
VALUES
(0, 'shop_dns'),
(1, 'shop_mvideo'),
(2, 'shop_sitilink');

INSERT INTO public.plan(product_id, shop_name, plan_cnt, plan_date)
VALUES
(0, 'shop_dns', 598, '2023-01-01'),
(1, 'shop_dns', 730, '2023-01-01'),
(2, 'shop_dns', 909, '2023-01-01'),
(0, 'shop_mvideo', 749, '2023-01-01'),
(1, 'shop_mvideo', 895, '2023-01-01'),
(2, 'shop_mvideo', 1051, '2023-01-01'),
(0, 'shop_sitilink', 894, '2023-01-01'),
(1, 'shop_sitilink', 1060, '2023-01-01'),
(2, 'shop_sitilink', 1200, '2023-01-01'),
(0, 'shop_dns', 602, '2023-02-01'),
(1, 'shop_dns', 749, '2023-02-01'),
(2, 'shop_dns', 899, '2023-02-01'),
(0, 'shop_mvideo', 736, '2023-02-01'),
(1, 'shop_mvideo', 891, '2023-02-01'),
(2, 'shop_mvideo', 1042, '2023-02-01'),
(0, 'shop_sitilink', 874, '2023-02-01'),
(1, 'shop_sitilink', 1051, '2023-02-01'),
(2, 'shop_sitilink', 1194, '2023-02-01');

INSERT INTO public.shop_dns(date, product_id, sales_cnt)
VALUES
('2023-01-01', 0, 16),
('2023-01-01', 1, 30),
('2023-01-01', 2, 26),
('2023-01-02', 0, 20),
('2023-01-02', 1, 23),
('2023-01-02', 2, 22),
('2023-01-03', 0, 23),
('2023-01-03', 1, 32),
('2023-01-03', 2, 27),
('2023-01-04', 0, 31),
('2023-01-04', 1, 15),
('2023-01-04', 2, 24),
('2023-01-05', 0, 19),
('2023-01-05', 1, 23),
('2023-01-05', 2, 27),
('2023-01-06', 0, 32),
('2023-01-06', 1, 34),
('2023-01-06', 2, 18),
('2023-01-07', 0, 11),
('2023-01-07', 1, 5),
('2023-01-07', 2, 30),
('2023-01-08', 0, 40),
('2023-01-08', 1, 26),
('2023-01-08', 2, 41),
('2023-01-09', 0, 17),
('2023-01-09', 1, 27),
('2023-01-09', 2, 28),
('2023-01-10', 0, 24),
('2023-01-10', 1, 45),
('2023-01-10', 2, 21),
('2023-01-11', 0, 24),
('2023-01-11', 1, 19),
('2023-01-11', 2, 44),
('2023-01-12', 0, 28),
('2023-01-12', 1, 24),
('2023-01-12', 2, 29),
('2023-01-13', 0, 25),
('2023-01-13', 1, 29),
('2023-01-13', 2, 13),
('2023-01-14', 0, 20),
('2023-01-14', 1, 10),
('2023-01-14', 2, 27),
('2023-01-15', 0, 19),
('2023-01-15', 1, 33),
('2023-01-15', 2, 35),
('2023-01-16', 0, 27),
('2023-01-16', 1, 9),
('2023-01-16', 2, 27),
('2023-01-17', 0, 12),
('2023-01-17', 1, 22),
('2023-01-17', 2, 30),
('2023-01-18', 0, 27),
('2023-01-18', 1, 12),
('2023-01-18', 2, 39),
('2023-01-19', 0, 14),
('2023-01-19', 1, 32),
('2023-01-19', 2, 32),
('2023-01-20', 0, 18),
('2023-01-20', 1, 39),
('2023-01-20', 2, 40),
('2023-01-21', 0, 13),
('2023-01-21', 1, 14),
('2023-01-21', 2, 30),
('2023-01-22', 0, 15),
('2023-01-22', 1, 31),
('2023-01-22', 2, 37),
('2023-01-23', 0, 27),
('2023-01-23', 1, 21),
('2023-01-23', 2, 40),
('2023-01-24', 0, 13),
('2023-01-24', 1, 26),
('2023-01-24', 2, 27),
('2023-01-25', 0, 20),
('2023-01-25', 1, 34),
('2023-01-25', 2, 37),
('2023-01-26', 0, 5),
('2023-01-26', 1, 14),
('2023-01-26', 2, 35),
('2023-01-27', 0, 23),
('2023-01-27', 1, 23),
('2023-01-27', 2, 32),
('2023-01-28', 0, 16),
('2023-01-28', 1, 33),
('2023-01-28', 2, 35),
('2023-01-29', 0, 23),
('2023-01-29', 1, 16),
('2023-01-29', 2, 31),
('2023-01-30', 0, 20),
('2023-01-30', 1, 19),
('2023-01-30', 2, 32),
('2023-01-31', 0, 17),
('2023-01-31', 1, 20),
('2023-01-31', 2, 31),
('2023-02-01', 0, 7),
('2023-02-01', 1, 50),
('2023-02-01', 2, 32),
('2023-02-02', 0, 18),
('2023-02-02', 1, 50),
('2023-02-02', 2, 21),
('2023-02-03', 0, 16),
('2023-02-03', 1, 25),
('2023-02-03', 2, 31),
('2023-02-04', 0, 26),
('2023-02-04', 1, 35),
('2023-02-04', 2, 28),
('2023-02-05', 0, 23),
('2023-02-05', 1, 14),
('2023-02-05', 2, 50),
('2023-02-06', 0, 0),
('2023-02-06', 1, 20),
('2023-02-06', 2, 44),
('2023-02-07', 0, 19),
('2023-02-07', 1, 14),
('2023-02-07', 2, 18),
('2023-02-08', 0, 15),
('2023-02-08', 1, 26),
('2023-02-08', 2, 26),
('2023-02-09', 0, 19),
('2023-02-09', 1, 34),
('2023-02-09', 2, 37),
('2023-02-10', 0, 28),
('2023-02-10', 1, 17),
('2023-02-10', 2, 38),
('2023-02-11', 0, 10),
('2023-02-11', 1, 17),
('2023-02-11', 2, 21),
('2023-02-12', 0, 29),
('2023-02-12', 1, 20),
('2023-02-12', 2, 43),
('2023-02-13', 0, 16),
('2023-02-13', 1, 21),
('2023-02-13', 2, 16),
('2023-02-14', 0, 10),
('2023-02-14', 1, 30),
('2023-02-14', 2, 29),
('2023-02-15', 0, 10),
('2023-02-15', 1, 26),
('2023-02-15', 2, 24),
('2023-02-16', 0, 4),
('2023-02-16', 1, 33),
('2023-02-16', 2, 13),
('2023-02-17', 0, 24),
('2023-02-17', 1, 12),
('2023-02-17', 2, 29),
('2023-02-18', 0, 1),
('2023-02-18', 1, 26),
('2023-02-18', 2, 37),
('2023-02-19', 0, 9),
('2023-02-19', 1, 24),
('2023-02-19', 2, 20),
('2023-02-20', 0, 16),
('2023-02-20', 1, 30),
('2023-02-20', 2, 28),
('2023-02-21', 0, 26),
('2023-02-21', 1, 24),
('2023-02-21', 2, 31),
('2023-02-22', 0, 19),
('2023-02-22', 1, 32),
('2023-02-22', 2, 26),
('2023-02-23', 0, 27),
('2023-02-23', 1, 32),
('2023-02-23', 2, 31),
('2023-02-24', 0, 15),
('2023-02-24', 1, 20),
('2023-02-24', 2, 37),
('2023-02-25', 0, 33),
('2023-02-25', 1, 25),
('2023-02-25', 2, 36),
('2023-02-26', 0, 18),
('2023-02-26', 1, 20),
('2023-02-26', 2, 32),
('2023-02-27', 0, 22),
('2023-02-27', 1, 16),
('2023-02-27', 2, 34),
('2023-02-28', 0, 26),
('2023-02-28', 1, 16),
('2023-02-28', 2, 23);

INSERT INTO public.shop_mvideo(date, product_id, sales_cnt)
VALUES
('2023-01-01', 0, 18),
('2023-01-01', 1, 30),
('2023-01-01', 2, 40),
('2023-01-02', 0, 17),
('2023-01-02', 1, 16),
('2023-01-02', 2, 24),
('2023-01-03', 0, 17),
('2023-01-03', 1, 31),
('2023-01-03', 2, 34),
('2023-01-04', 0, 20),
('2023-01-04', 1, 17),
('2023-01-04', 2, 42),
('2023-01-05', 0, 16),
('2023-01-05', 1, 42),
('2023-01-05', 2, 30),
('2023-01-06', 0, 32),
('2023-01-06', 1, 24),
('2023-01-06', 2, 30),
('2023-01-07', 0, 24),
('2023-01-07', 1, 31),
('2023-01-07', 2, 31),
('2023-01-08', 0, 24),
('2023-01-08', 1, 18),
('2023-01-08', 2, 34),
('2023-01-09', 0, 20),
('2023-01-09', 1, 17),
('2023-01-09', 2, 41),
('2023-01-10', 0, 22),
('2023-01-10', 1, 16),
('2023-01-10', 2, 27),
('2023-01-11', 0, 24),
('2023-01-11', 1, 38),
('2023-01-11', 2, 29),
('2023-01-12', 0, 26),
('2023-01-12', 1, 47),
('2023-01-12', 2, 33),
('2023-01-13', 0, 18),
('2023-01-13', 1, 27),
('2023-01-13', 2, 33),
('2023-01-14', 0, 18),
('2023-01-14', 1, 25),
('2023-01-14', 2, 45),
('2023-01-15', 0, 16),
('2023-01-15', 1, 29),
('2023-01-15', 2, 28),
('2023-01-16', 0, 24),
('2023-01-16', 1, 29),
('2023-01-16', 2, 48),
('2023-01-17', 0, 30),
('2023-01-17', 1, 25),
('2023-01-17', 2, 29),
('2023-01-18', 0, 23),
('2023-01-18', 1, 30),
('2023-01-18', 2, 22),
('2023-01-19', 0, 18),
('2023-01-19', 1, 41),
('2023-01-19', 2, 24),
('2023-01-20', 0, 15),
('2023-01-20', 1, 13),
('2023-01-20', 2, 33),
('2023-01-21', 0, 19),
('2023-01-21', 1, 32),
('2023-01-21', 2, 33),
('2023-01-22', 0, 17),
('2023-01-22', 1, 29),
('2023-01-22', 2, 26),
('2023-01-23', 0, 17),
('2023-01-23', 1, 21),
('2023-01-23', 2, 31),
('2023-01-24', 0, 32),
('2023-01-24', 1, 32),
('2023-01-24', 2, 25),
('2023-01-25', 0, 41),
('2023-01-25', 1, 35),
('2023-01-25', 2, 34),
('2023-01-26', 0, 22),
('2023-01-26', 1, 26),
('2023-01-26', 2, 38),
('2023-01-27', 0, 43),
('2023-01-27', 1, 49),
('2023-01-27', 2, 21),
('2023-01-28', 0, 31),
('2023-01-28', 1, 14),
('2023-01-28', 2, 32),
('2023-01-29', 0, 25),
('2023-01-29', 1, 19),
('2023-01-29', 2, 35),
('2023-01-30', 0, 44),
('2023-01-30', 1, 62),
('2023-01-30', 2, 44),
('2023-01-31', 0, 29),
('2023-01-31', 1, 35),
('2023-01-31', 2, 20),
('2023-02-01', 0, 28),
('2023-02-01', 1, 8),
('2023-02-01', 2, 34),
('2023-02-02', 0, 29),
('2023-02-02', 1, 40),
('2023-02-02', 2, 42),
('2023-02-03', 0, 25),
('2023-02-03', 1, 14),
('2023-02-03', 2, 37),
('2023-02-04', 0, 29),
('2023-02-04', 1, 44),
('2023-02-04', 2, 38),
('2023-02-05', 0, 26),
('2023-02-05', 1, 25),
('2023-02-05', 2, 49),
('2023-02-06', 0, 27),
('2023-02-06', 1, 22),
('2023-02-06', 2, 41),
('2023-02-07', 0, 42),
('2023-02-07', 1, 26),
('2023-02-07', 2, 36),
('2023-02-08', 0, 40),
('2023-02-08', 1, 17),
('2023-02-08', 2, 42),
('2023-02-09', 0, 24),
('2023-02-09', 1, 25),
('2023-02-09', 2, 43),
('2023-02-10', 0, 17),
('2023-02-10', 1, 31),
('2023-02-10', 2, 31),
('2023-02-11', 0, 19),
('2023-02-11', 1, 21),
('2023-02-11', 2, 26),
('2023-02-12', 0, 36),
('2023-02-12', 1, 27),
('2023-02-12', 2, 33),
('2023-02-13', 0, 32),
('2023-02-13', 1, 37),
('2023-02-13', 2, 42),
('2023-02-14', 0, 40),
('2023-02-14', 1, 43),
('2023-02-14', 2, 18),
('2023-02-15', 0, 26),
('2023-02-15', 1, 25),
('2023-02-15', 2, 15),
('2023-02-16', 0, 25),
('2023-02-16', 1, 35),
('2023-02-16', 2, 27),
('2023-02-17', 0, 22),
('2023-02-17', 1, 26),
('2023-02-17', 2, 42),
('2023-02-18', 0, 24),
('2023-02-18', 1, 31),
('2023-02-18', 2, 39),
('2023-02-19', 0, 32),
('2023-02-19', 1, 27),
('2023-02-19', 2, 44),
('2023-02-20', 0, 20),
('2023-02-20', 1, 43),
('2023-02-20', 2, 53),
('2023-02-21', 0, 26),
('2023-02-21', 1, 15),
('2023-02-21', 2, 27),
('2023-02-22', 0, 9),
('2023-02-22', 1, 28),
('2023-02-22', 2, 55),
('2023-02-23', 0, 34),
('2023-02-23', 1, 28),
('2023-02-23', 2, 54),
('2023-02-24', 0, 33),
('2023-02-24', 1, 21),
('2023-02-24', 2, 31),
('2023-02-25', 0, 30),
('2023-02-25', 1, 29),
('2023-02-25', 2, 32),
('2023-02-26', 0, 35),
('2023-02-26', 1, 24),
('2023-02-26', 2, 35),
('2023-02-27', 0, 37),
('2023-02-27', 1, 29),
('2023-02-27', 2, 39),
('2023-02-28', 0, 26),
('2023-02-28', 1, 29),
('2023-02-28', 2, 51);

INSERT INTO public.shop_sitilink(date, product_id, sales_cnt)
VALUES
('2023-01-01', 0, 27),
('2023-01-01', 1, 39),
('2023-01-01', 2, 31),
('2023-01-02', 0, 28),
('2023-01-02', 1, 30),
('2023-01-02', 2, 40),
('2023-01-03', 0, 28),
('2023-01-03', 1, 37),
('2023-01-03', 2, 39),
('2023-01-04', 0, 37),
('2023-01-04', 1, 42),
('2023-01-04', 2, 36),
('2023-01-05', 0, 11),
('2023-01-05', 1, 15),
('2023-01-05', 2, 27),
('2023-01-06', 0, 27),
('2023-01-06', 1, 44),
('2023-01-06', 2, 36),
('2023-01-07', 0, 41),
('2023-01-07', 1, 31),
('2023-01-07', 2, 56),
('2023-01-08', 0, 18),
('2023-01-08', 1, 43),
('2023-01-08', 2, 38),
('2023-01-09', 0, 16),
('2023-01-09', 1, 44),
('2023-01-09', 2, 40),
('2023-01-10', 0, 28),
('2023-01-10', 1, 43),
('2023-01-10', 2, 18),
('2023-01-11', 0, 36),
('2023-01-11', 1, 33),
('2023-01-11', 2, 29),
('2023-01-12', 0, 39),
('2023-01-12', 1, 35),
('2023-01-12', 2, 28),
('2023-01-13', 0, 25),
('2023-01-13', 1, 39),
('2023-01-13', 2, 40),
('2023-01-14', 0, 29),
('2023-01-14', 1, 34),
('2023-01-14', 2, 60),
('2023-01-15', 0, 44),
('2023-01-15', 1, 46),
('2023-01-15', 2, 47),
('2023-01-16', 0, 26),
('2023-01-16', 1, 39),
('2023-01-16', 2, 39),
('2023-01-17', 0, 17),
('2023-01-17', 1, 43),
('2023-01-17', 2, 42),
('2023-01-18', 0, 34),
('2023-01-18', 1, 42),
('2023-01-18', 2, 43),
('2023-01-19', 0, 30),
('2023-01-19', 1, 34),
('2023-01-19', 2, 39),
('2023-01-20', 0, 27),
('2023-01-20', 1, 27),
('2023-01-20', 2, 38),
('2023-01-21', 0, 18),
('2023-01-21', 1, 40),
('2023-01-21', 2, 49),
('2023-01-22', 0, 35),
('2023-01-22', 1, 27),
('2023-01-22', 2, 12),
('2023-01-23', 0, 29),
('2023-01-23', 1, 33),
('2023-01-23', 2, 46),
('2023-01-24', 0, 32),
('2023-01-24', 1, 40),
('2023-01-24', 2, 39),
('2023-01-25', 0, 34),
('2023-01-25', 1, 41),
('2023-01-25', 2, 43),
('2023-01-26', 0, 46),
('2023-01-26', 1, 37),
('2023-01-26', 2, 34),
('2023-01-27', 0, 42),
('2023-01-27', 1, 32),
('2023-01-27', 2, 43),
('2023-01-28', 0, 13),
('2023-01-28', 1, 18),
('2023-01-28', 2, 38),
('2023-01-29', 0, 17),
('2023-01-29', 1, 47),
('2023-01-29', 2, 47),
('2023-01-30', 0, 42),
('2023-01-30', 1, 42),
('2023-01-30', 2, 37),
('2023-01-31', 0, 28),
('2023-01-31', 1, 37),
('2023-01-31', 2, 38),
('2023-02-01', 0, 25),
('2023-02-01', 1, 44),
('2023-02-01', 2, 57),
('2023-02-02', 0, 40),
('2023-02-02', 1, 39),
('2023-02-02', 2, 42),
('2023-02-03', 0, 30),
('2023-02-03', 1, 34),
('2023-02-03', 2, 48),
('2023-02-04', 0, 37),
('2023-02-04', 1, 27),
('2023-02-04', 2, 46),
('2023-02-05', 0, 21),
('2023-02-05', 1, 40),
('2023-02-05', 2, 48),
('2023-02-06', 0, 25),
('2023-02-06', 1, 36),
('2023-02-06', 2, 54),
('2023-02-07', 0, 32),
('2023-02-07', 1, 36),
('2023-02-07', 2, 40),
('2023-02-08', 0, 20),
('2023-02-08', 1, 41),
('2023-02-08', 2, 35),
('2023-02-09', 0, 30),
('2023-02-09', 1, 37),
('2023-02-09', 2, 29),
('2023-02-10', 0, 34),
('2023-02-10', 1, 36),
('2023-02-10', 2, 40),
('2023-02-11', 0, 24),
('2023-02-11', 1, 28),
('2023-02-11', 2, 41),
('2023-02-12', 0, 31),
('2023-02-12', 1, 20),
('2023-02-12', 2, 37),
('2023-02-13', 0, 36),
('2023-02-13', 1, 36),
('2023-02-13', 2, 51),
('2023-02-14', 0, 31),
('2023-02-14', 1, 34),
('2023-02-14', 2, 38),
('2023-02-15', 0, 32),
('2023-02-15', 1, 30),
('2023-02-15', 2, 44),
('2023-02-16', 0, 22),
('2023-02-16', 1, 34),
('2023-02-16', 2, 39),
('2023-02-17', 0, 30),
('2023-02-17', 1, 42),
('2023-02-17', 2, 43),
('2023-02-18', 0, 40),
('2023-02-18', 1, 36),
('2023-02-18', 2, 41),
('2023-02-19', 0, 30),
('2023-02-19', 1, 34),
('2023-02-19', 2, 44),
('2023-02-20', 0, 32),
('2023-02-20', 1, 32),
('2023-02-20', 2, 35),
('2023-02-21', 0, 20),
('2023-02-21', 1, 23),
('2023-02-21', 2, 43),
('2023-02-22', 0, 31),
('2023-02-22', 1, 38),
('2023-02-22', 2, 49),
('2023-02-23', 0, 22),
('2023-02-23', 1, 40),
('2023-02-23', 2, 41),
('2023-02-24', 0, 27),
('2023-02-24', 1, 27),
('2023-02-24', 2, 36),
('2023-02-25', 0, 36),
('2023-02-25', 1, 28),
('2023-02-25', 2, 56),
('2023-02-26', 0, 23),
('2023-02-26', 1, 42),
('2023-02-26', 2, 37),
('2023-02-27', 0, 20),
('2023-02-27', 1, 23),
('2023-02-27', 2, 36),
('2023-02-28', 0, 27),
('2023-02-28', 1, 43),
('2023-02-28', 2, 47);

INSERT INTO public.promo(shop_id, promo_date, product_id, discount)
VALUES
(0, '2023-01-10', 1, 0.25),
(0, '2023-01-11', 1, 0.25),

(0, '2023-01-30', 0, 0.2),
(0, '2023-01-31', 0, 0.2),
(0, '2023-02-01', 0, 0.2),
(0, '2023-02-02', 0, 0.2),

(1, '2023-01-15', 2, 0.35),
(1, '2023-01-16', 2, 0.35),
(1, '2023-01-17', 2, 0.35),
(1, '2023-01-18', 2, 0.35),
(1, '2023-01-19', 2, 0.35),

(1, '2023-02-21', 2, 0.3),
(1, '2023-02-22', 2, 0.3),
(1, '2023-02-23', 2, 0.3);