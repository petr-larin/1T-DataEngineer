## Задание ПРО по теме 2.8 «Введение в колоночные СУБД. Clickhouse»‎

Для выполнения задания использовался готовый [датасет «Superstore»‎](https://www.kaggle.com/datasets/vivek468/superstore-dataset-final) с Kaggle. В датасете приводятся данные о продажах по датам, товарам, категориям, подкатегориям и прочим параметрам за период с 2014 по 2017 включительно.

* Файл `problems-1-3-4.sql` содержит решения подзаданий 1, 3 и 4.
* Файл `problem-2.sql` содержит решение подзадания 2.

### Описание:

Вы работаете с данными о продажах товаров в магазине и должны выполнить ряд аналитических задач, используя ClickHouse. Ваши задачи включают в себя:

1. Агрегация данных:

* Вычислите общую сумму продаж по каждой категории товаров за последний месяц.

* Определите средний чек покупателей за последний год.

2. Промежуточные состояния:

* Сначала вычислите средние продажи для каждой категории товаров в течение квартала с использованием -State комбинатора и функции avgState.

* Затем объедините промежуточные результаты с использованием -Merge комбинатора, чтобы вычислить общую среднюю продажу за квартал.

3. Работа с окнами данных:

* Определите топ-5 товаров с наибольшей выручкой за последние 7 дней.

* Найдите кумулятивную сумму продаж для каждой категории товаров за последние 3 месяца.

4. Оптимизация запросов:

* Создайте отчет о продажах за последний год и сохраните его в отдельной таблице с использованием оператора INSERT.

* Затем выполните запрос, который объединяет данные из этой таблицы с текущими данными о продажах и вычисляет общую сумму продаж за последний год.

Примечания:

1. Обратитесь к документации по Clickhouse для изучения синтаксиса и возможностей этой СУБД.

2. Убедитесь, что SQL-скрипт содержит все необходимые инструкции для создания и настройки витрины, включая создание таблиц, определение ключей, индексов и прочих элементов, учтите требования к типам данных и настройкам Clickhouse.

3. Предоставьте SQL-скрипт в удобном формате (например, текстовый файл с расширением .sql).