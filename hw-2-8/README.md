## Задание по теме 2.8 «Введение в колоночные СУБД. Clickhouse»‎

Расчет кумулятивной выручки и среднего чека по категориям товаров с использованием оконных функций

Вам нужно будет создать или использовать следующие поля в таблице:

1. category (категория товара): Это поле будет содержать информацию о категории товара, по которой вы будете группировать данные.

2. order_date (дата заказа): Это поле будет содержать дату каждого заказа.

3. revenue (выручка): Это поле будет содержать сумму выручки для каждой продажи.

4. cumulative_revenue (кумулятивная выручка): Это поле будет содержать результаты расчета кумулятивной выручки с использованием оконных функций.

5. cumulative_orders (кумулятивное количество заказов): Это поле будет содержать кумулятивное количество заказов для каждой категории товаров.

6. average_check (средний чек): Это поле будет содержать результаты расчета среднего чека с использованием оконных функций.

7. max_avg_check_date (дата максимального среднего чека): Это поле будет содержать дату, на которой был достигнут максимальный средний чек.

8. max_avg_check_value (значение максимального среднего чека): Это поле будет содержать значение максимального среднего чека для каждой категории товаров.

Описание:

У вас есть таблица sales с данными о продажах товаров. Ваша задача — рассчитать кумулятивную выручку и средний чек для каждой категории товаров с использованием оконных функций ClickHouse. Это задание включает в себя следующие шаги:

1. Расчет кумулятивной выручки:

* Для каждой категории товаров (category) вычислите кумулятивную выручку на каждый день. Это означает, что для каждой даты вам нужно будет посчитать сумму выручки для данной категории товаров на эту дату и для всех предыдущих дат.

2. Расчет среднего чека:

* Для каждой категории товаров на каждый день вычислите средний чек, который равен кумулятивной выручке на этот день, поделенной на кумулятивное количество заказов на этот день.

3. Определение даты максимального среднего чека:

* Найдите дату, на которой был достигнут максимальный средний чек для каждой категории товаров, а также значение этого максимального среднего чека.